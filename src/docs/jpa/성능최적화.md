# 성능 최적화 

## 읽기 전용 쿼리의 성능 최적화 
- 엔티티가 영속성 컨텍스트에 관리되면 1차 캐시부터 변경 감지까지 얻을 수 있는 혜택이 많다
- 하지만, 영속성 컨텍스트는 **변경 감지를 위해 스냅샷 인스턴스를 보관하므로 더 많은 메모리를 사용하는 단점이 있다.**

- 따라서 읽기 전용으로 엔티티를 조회하면 메모리 사용량을 최적화 할 수 있다.

### 스칼라 타입으로 조회 
- 엔티티가 아닌 타입으로 모든 필드를 조회하면 성능 최적화 가능
- 타입으로 조회하면 영속성 컨텍스트가 결과를 관리하지 않기 때문!

### 읽기 전용 트랜잭션 사용 
- `@Transactional(readOnly = true)` 를 사용하면 트랜잭션을 읽기 전용으로 사용할 수 있다.


### 트랜잭션 밖에서 읽기
- 트랜잭션 밖에서 엔티티를 조회하면 영속성 컨텍스트가 관리하지 않는다.
- `@Transactional(propagation = Propagation.NOT_SUPPORTED)` 를 사용하면 트랜잭션을 사용하지 않는다.
  - 상위 메서드에서 트랜잭션이 실행되어도 그 트랜잭션이 일시 중지되고, 메서드가 트랜잭션 없이실행된다!


